---
title: Skin Weights Transfer
category: rig
description: インフルエンス間でスキンウェイトを移動するツール
lang: ja
lang-ref: skin_weights_transfer
order: 125
---

## 概要

Skin Weights Transfer は、選択したコンポーネント上で、複数のソースインフルエンスから単一のターゲットインフルエンスにスキンウェイトを移動するツールです。

ソースインフルエンスのウェイトは比例配分で減算され、その分がターゲットインフルエンスに加算されます。移動量はスライダーで 0〜100% の範囲で調整できます。

## 起動方法

専用のメニューか、以下のコマンドでツールを起動します。

```python
import faketools.tools.rig.skin_weights_transfer.ui
faketools.tools.rig.skin_weights_transfer.ui.show_ui()
```

## 使用方法

ウェイトを移動するには、以下の手順を行います。

1. skinCluster が設定されたメッシュまたはコンポーネントを選択し、`SET` ボタンをクリックして skinCluster を設定します。
2. 左側の **Source (from)** リストから、ウェイトの移動元となるインフルエンスを選択します（複数選択可: Ctrl+クリック / Shift+クリック）。
3. 右側の **Target (to)** リストから、ウェイトの移動先となるインフルエンスを 1 つ選択します。
4. 対象となる頂点・CV・ラティスポイントを選択します。
5. **Amount** スライダーで移動量（0〜100%）を設定します。
6. 実行ボタンをクリックしてウェイトを移動します。

## オプション

### SkinCluster

操作対象の skinCluster を設定します。

- メッシュまたはコンポーネントを選択した状態で `SET` ボタンをクリックすると、選択されたオブジェクトに設定されている skinCluster が自動的に検出されます。
- 検出された skinCluster 名がフィールドに表示されます。

### インフルエンスフィルター

インフルエンスリストの表示を絞り込む機能です。

- **テキストフィルター**: スペース区切りでキーワードを入力すると、いずれかのキーワードを含むインフルエンスのみが表示されます（OR 検索）。
- **Affected Only ボタン**: オンにすると、現在選択しているコンポーネントに対してウェイトが 0 より大きいインフルエンスのみが表示されます。表示順はウェイトの合計値が大きい順にソートされます。Maya の選択を変更するとリアルタイムに更新されます。

### Source (from) リスト

ウェイトの移動元となるインフルエンスを選択します。

- 複数のインフルエンスを選択できます（Ctrl+クリック / Shift+クリック）。
- 選択中のインフルエンス数がラベルに `[N]` の形式で表示されます。
- リストで選択したインフルエンスは Maya ビューポート上でハイライト表示されます。

### Target (to) リスト

ウェイトの移動先となるインフルエンスを選択します。

- 1 つのインフルエンスのみ選択できます。
- Source と同じインフルエンスを Target に設定することはできません（Source が 1 つの場合）。

### Amount

ソースインフルエンスのウェイトを移動する割合を 0〜100% で指定します。

- **100%**: ソースインフルエンスのウェイトをすべてターゲットに移動します。
- **50%**: ソースインフルエンスのウェイトの半分をターゲットに移動します。
- **0%**: ウェイトは移動されません。

複数のソースインフルエンスが選択されている場合、各ソースのウェイトは保有比率に応じて比例配分で減算されます。

## ウェイト移動の仕組み

各コンポーネントに対して以下の計算が行われます。

1. すべてのソースインフルエンスのウェイト合計を算出します。
2. 合計に Amount の割合を掛けて、移動量を算出します。
3. 各ソースインフルエンスから、保有比率に応じてウェイトを比例配分で減算します。
4. 減算した合計分をターゲットインフルエンスに加算します。

**例:**
- Source A のウェイト: 0.6、Source B のウェイト: 0.3、Amount: 50% の場合
- 移動量: (0.6 + 0.3) × 0.5 = 0.45
- Source A から減算: 0.45 × (0.6 / 0.9) = 0.30 → 残り 0.30
- Source B から減算: 0.45 × (0.3 / 0.9) = 0.15 → 残り 0.15
- Target に加算: +0.45

## 対象コンポーネント

以下のコンポーネントタイプに対応しています。

- 頂点（Vertex）
- CV（Control Vertex）
- ラティスポイント（Lattice Point）

選択されたコンポーネントが skinCluster のジオメトリに属していない場合、エラーとなります。

---
title: Offset Curve to Surface
category: rig
description: カーブをオフセットしてNURBSサーフェスを作成するツール
lang: ja
lang-ref: offset_curve_to_surface
---

## 概要

選択した NURBS カーブの CV 位置を指定した方向にオフセットし、ロフトされた NURBS サーフェスを作成します。

オフセット方向として、任意のベクトル、カーブの法線・従法線、参照メッシュ・サーフェスの法線・従法線を選択できます。

## 起動方法

専用のメニューか、以下のコマンドでツールを起動します。

```python
import faketools.tools.rig.offset_curve_to_surface.ui
faketools.tools.rig.offset_curve_to_surface.ui.show_ui()
```

画像１：Offset Curve to Surface ツールのUI

## 使用方法

1. NURBS カーブを選択します（複数選択可能）。
2. オフセット方向を `Axis` から選択します。
3. 必要に応じてオプションを設定します。
4. `Create` ボタンを押すことでサーフェスが作成されます。

画像２：基本的な使用例（カーブからサーフェスを作成）

## オプション

### Axis（オフセット方向）

画像３：Axis オプションの選択

サーフェスを作成する方向を指定します。

* **Vector**
  * 任意のベクトル方向にオフセットします。
  * `Vector` フィールドで X, Y, Z の方向を指定します。

* **Normal**
  * カーブの法線方向にオフセットします。
  * カーブの各 CV 位置における法線方向を使用します。

* **Binormal**
  * カーブの従法線方向にオフセットします。
  * カーブの各 CV 位置における従法線方向（法線と接線の外積）を使用します。

* **Mesh Normal**
  * 参照メッシュの法線方向にオフセットします。
  * `Reference` フィールドで参照するメッシュを指定する必要があります。
  * カーブの各 CV 位置から参照メッシュ上の最も近い点を探し、その位置の法線方向を使用します。

* **Mesh Binormal**
  * 参照メッシュの従法線方向にオフセットします。
  * `Reference` フィールドで参照するメッシュを指定する必要があります。
  * メッシュの法線方向とカーブの接線方向の外積を使用します。

* **Surface Normal**
  * 参照サーフェスの法線方向にオフセットします。
  * `Reference` フィールドで参照する NURBS サーフェスを指定する必要があります。
  * カーブの各 CV 位置から参照サーフェス上の最も近い点を探し、その位置の法線方向を使用します。

* **Surface Binormal**
  * 参照サーフェスの従法線方向にオフセットします。
  * `Reference` フィールドで参照する NURBS サーフェスを指定する必要があります。
  * サーフェスの法線方向とカーブの接線方向の外積を使用します。

画像４：各オフセット方向の比較図

### Vector（ベクトル方向）

画像５：Vector オプション

`Axis` が `Vector` の場合のみ有効です。

* X, Y, Z の 3 つのスピンボックスでオフセット方向のベクトルを指定します。
* ベクトルは自動的に正規化されます。
* デフォルト値は (0.0, 1.0, 0.0) です。

### Reference（参照オブジェクト）

画像６：Reference オプション

`Axis` が `Mesh Normal`, `Mesh Binormal`, `Surface Normal`, `Surface Binormal` の場合のみ有効です。

* 参照するメッシュまたは NURBS サーフェスを指定します。
* 参照オブジェクトを選択し、`<<` ボタンを押すことで設定できます。
* `Mesh Normal` / `Mesh Binormal` の場合は、メッシュを指定してください。
* `Surface Normal` / `Surface Binormal` の場合は、NURBS サーフェスを指定してください。

### Width（サーフェスの幅）

画像７：Width と Center オプション

* **Width**
  * サーフェスの幅を指定します。
  * デフォルト値は 1.0 です。
  * 範囲：0.001 ～ 10000.0

* **Center**
  * サーフェースの作成方向に対して、この値を中心にサーフェースを作成します。
  * 0.5 でサーフェースはプラスマイナス同じ幅になります。
  * 例えば、Width が 10.0 で Center が 0.5 の場合、サーフェースは -5.0 から 5.0 までの幅になります。
  * デフォルト値は 0.5 です。
  * 範囲：0.0 ～ 1.0

画像８：Width と Center の値による結果の違い

## 使用例

### 例1：ベクトル方向でサーフェスを作成

1. カーブを選択します。
2. `Axis` を `Vector` に設定します。
3. `Vector` を (0.0, 1.0, 0.0) に設定します（Y軸方向）。
4. `Width` を 2.0 に設定します。
5. `Create` ボタンを押します。

画像９：ベクトル方向でのサーフェス作成例

### 例2：カーブの法線方向でサーフェスを作成

1. カーブを選択します。
2. `Axis` を `Normal` に設定します。
3. `Width` を 1.0 に設定します。
4. `Create` ボタンを押します。

画像１０：カーブの法線方向でのサーフェス作成例

### 例3：メッシュの法線方向でサーフェスを作成

1. カーブを選択します。
2. `Axis` を `Mesh Normal` に設定します。
3. 参照メッシュを選択し、`<<` ボタンを押して `Reference` に設定します。
4. `Width` を 0.5 に設定します。
5. `Create` ボタンを押します。

画像１１：メッシュの法線方向でのサーフェス作成例

## プリセット機能

ツールの設定はプリセットとして保存・読み込みが可能です。

画像１２：プリセットメニュー

* **Presets メニュー**
  * `Save Preset...` : 現在の設定を新しいプリセットとして保存します。
  * `Rename Preset...` : 選択中のプリセット名を変更します。
  * `Delete Preset...` : 選択中のプリセットを削除します。
  * `Export Preset...` : 選択中のプリセットを外部ファイルにエクスポートします。
  * `Import Preset...` : 外部ファイルからプリセットをインポートします。

## 注意事項

* カーブの次数は選択したカーブから自動的に取得されます。
* トランスフォームノードまたはシェイプノードを選択しても動作します。
* 複数のカーブを選択した場合、それぞれのカーブに対してサーフェスが作成されます。
* 作成されたサーフェスは自動的に選択されます。
* `Vector` が (0, 0, 0) の場合はエラーになります。
* 参照オブジェクトが必要な Axis を選択した場合、必ず適切なタイプのオブジェクトを `Reference` に設定してください。
